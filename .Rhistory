# print contrasts
contrasts(C7T15$Education.lbl)
# represent these contrasts as numeric variables
# first column represents the intercept contrast
# second column represents the dummy coded contrast (-0.5 = No degree, 0.5 = Degree)
C7T15$degree.contrast <- model.matrix.lm(~ Education.lbl, data = C7T15)[, 2]
# Chunk 9
C7T15 %>%
ggplot(mapping = aes(x = Sex.lbl, y = Salary, color = Education.lbl)) +
geom_violin(position = position_dodge(width = 0.90), alpha = 0) +
geom_boxplot(position = position_dodge(width = 0.90), width = 0.25, alpha = 0, outlier.color = NULL) +
geom_point(position = position_jitterdodge(jitter.width = 0.20, jitter.height = 0.20, dodge.width = 0.90)) +
scale_y_continuous(breaks = seq(0, 30000, 2000)) +
labs(x = "Sex", y = "Salary", color = "Education") +
theme_bw()
# Chunk 10
C7T15 %>%
ggplot(mapping = aes(x = Sex.lbl, y = Salary, fill = Education.lbl)) +
stat_summary(geom = "bar", fun.data = mean_cl_normal, position = position_dodge(width = 0.90)) +
stat_summary(geom = "errorbar", fun.data = mean_cl_normal, position = position_dodge(width = 0.90), width = 0) +
scale_y_continuous(breaks = seq(0, 40000, 2000)) +
labs(x = "Sex", y = "Salary", color = "Education") +
theme_bw()
# Chunk 11
lm.dummy <- lm(Salary ~ female.dummy * degree.dummy, data = C7T15)
# Chunk 12
lm.contrast <- lm(Salary ~ female.contrast * degree.contrast, data = C7T15)
# Chunk 13
group.means <- with(C7T15, by(Salary, Sex.Education, mean))
# Chunk 14
C7T15 %>%
count(Sex.lbl, Education.lbl, Sex.Education, female.dummy, degree.dummy, female.dummy * degree.dummy) %>%
rename(interaction = `female.dummy * degree.dummy`) %>%
kable()
# Chunk 15
summary(lm.dummy)
# Chunk 16
# coefficients
lm.dummy.coef <- coefficients(lm.dummy)
# b0/intercept
b0.dummy <- lm.dummy.coef[1]
# b1
b1.dummy <- lm.dummy.coef[2]
# b2
b2.dummy <- lm.dummy.coef[3]
# b3/interaction
b3.dummy <- lm.dummy.coef[4]
# Chunk 17
# apply weights for male & no degree
lm.dummy.coef %*% c(1, 0, 0, 0)
# b0/intercept
b0.dummy
# male & no degree
group.means["Male & No degree"]
# Chunk 18
# apply weights for female & no degree
lm.dummy.coef %*% c(1, 1, 0, 0)
# female & no degree
group.means["Female & No degree"]
# b1
b1.dummy
# female & no degree - male & no degree
group.means["Female & No degree"] - group.means["Male & No degree"]
# Chunk 19
# apply weights for male & degree
lm.dummy.coef %*% c(1, 0, 1, 0)
# female & no degree
group.means["Male & Degree"]
# b1
b2.dummy
# male & degree - male & no degree
group.means["Male & Degree"] - group.means["Male & No degree"]
# Chunk 20
# apply weights for female & degree
lm.dummy.coef %*% c(1, 1, 1, 1)
# female & degree
group.means["Female & Degree"]
# b3
b3.dummy
# female & degree + male & no degree - female & no degree - male & degree
group.means["Female & Degree"] + group.means["Male & No degree"] - group.means["Female & No degree"] - group.means["Male & Degree"]
# Chunk 21
summary(lm.contrast)
C7T15 %>%
count(Sex.lbl, Education.lbl, Sex.Education, female.contrast, degree.contrast, female.contrast * degree.contrast) %>%
rename(interaction = `female.contrast * degree.contrast`)
C7T15 %>%
count(Sex.lbl, Education.lbl, Sex.Education, female.contrast, degree.contrast, female.contrast * degree.contrast) %>%
rename(interaction = `female.contrast * degree.contrast`) %>% View()
# Chunk 1
# install.packages("tidyverse")
# install.packages("knitr")
# install.packages("AMCP")
library(tidyverse)
library(knitr)
library(AMCP)
# Chunk 2
data("C7T15")
# Chunk 3
C7T15 %>%
kable()
# Chunk 4
C7T15$Salary <- C7T15$Salary * 1000
# Chunk 5
C7T15 <- C7T15 %>%
mutate(Sex.lbl = factor(recode(Sex, "1" = "Male", "2" = "Female"), levels = c("Male", "Female"), labels = c("Male", "Female")),
Education.lbl = factor(recode(Education, "1" = "No degree", "2" = "Degree"), levels = c("No degree", "Degree"), labels = c("No degree", "Degree")),
Sex.Education = interaction(Sex.lbl, Education.lbl, sep = " & "))
# Chunk 6
# print contrasts
contrasts(C7T15$Sex.lbl)
# represent these contrasts as numeric variables
# first column represents the intercept contrast
# second column represents the dummy coded contrast (0 = Male, 1 = Female)
C7T15$female.dummy <- model.matrix.lm(~ Sex.lbl, data = C7T15)[, 2]
# Chunk 7
# print contrasts
contrasts(C7T15$Education.lbl)
# represent these contrasts as numeric variables
# first column represents the intercept contrast
# second column represents the dummy coded contrast (0 = No degree, 1 = Degree)
C7T15$degree.dummy <- model.matrix.lm(~ Education.lbl, data = C7T15)[, 2]
# Chunk 8
# create new contrasts
contrasts(C7T15$Sex.lbl) <- cbind(Female = c(-1, 1) / 2)
# print contrasts
contrasts(C7T15$Sex.lbl)
# represent these contrasts as numeric variables
# first column represents the intercept contrast
# second column represents the dummy coded contrast (-0.5 = Male, 0.5 = Female)
C7T15$female.contrast <- model.matrix.lm(~ Sex.lbl, data = C7T15)[, 2]
# create new contrasts
contrasts(C7T15$Education.lbl) <- cbind(Degree = c(-1, 1) / 2)
# print contrasts
contrasts(C7T15$Education.lbl)
# represent these contrasts as numeric variables
# first column represents the intercept contrast
# second column represents the dummy coded contrast (-0.5 = No degree, 0.5 = Degree)
C7T15$degree.contrast <- model.matrix.lm(~ Education.lbl, data = C7T15)[, 2]
# Chunk 9
C7T15 %>%
ggplot(mapping = aes(x = Sex.lbl, y = Salary, color = Education.lbl)) +
geom_violin(position = position_dodge(width = 0.90), alpha = 0) +
geom_boxplot(position = position_dodge(width = 0.90), width = 0.25, alpha = 0, outlier.color = NULL) +
geom_point(position = position_jitterdodge(jitter.width = 0.20, jitter.height = 0.20, dodge.width = 0.90)) +
scale_y_continuous(breaks = seq(0, 30000, 2000)) +
labs(x = "Sex", y = "Salary", color = "Education") +
theme_bw()
# Chunk 10
C7T15 %>%
ggplot(mapping = aes(x = Sex.lbl, y = Salary, fill = Education.lbl)) +
stat_summary(geom = "bar", fun.data = mean_cl_normal, position = position_dodge(width = 0.90)) +
stat_summary(geom = "errorbar", fun.data = mean_cl_normal, position = position_dodge(width = 0.90), width = 0) +
scale_y_continuous(breaks = seq(0, 40000, 2000)) +
labs(x = "Sex", y = "Salary", color = "Education") +
theme_bw()
# Chunk 11
lm.dummy <- lm(Salary ~ female.dummy * degree.dummy, data = C7T15)
# Chunk 12
lm.contrast <- lm(Salary ~ female.contrast * degree.contrast, data = C7T15)
# Chunk 13
group.means <- with(C7T15, by(Salary, Sex.Education, mean))
# Chunk 14
C7T15 %>%
count(Sex.lbl, Education.lbl, Sex.Education, female.dummy, degree.dummy, female.dummy * degree.dummy) %>%
rename(interaction = `female.dummy * degree.dummy`) %>%
kable()
# Chunk 15
summary(lm.dummy)
# Chunk 16
# coefficients
lm.dummy.coef <- coefficients(lm.dummy)
# b0/intercept
b0.dummy <- lm.dummy.coef[1]
# b1
b1.dummy <- lm.dummy.coef[2]
# b2
b2.dummy <- lm.dummy.coef[3]
# b3/interaction
b3.dummy <- lm.dummy.coef[4]
# Chunk 17
# apply weights for male & no degree
lm.dummy.coef %*% c(1, 0, 0, 0)
# b0/intercept
b0.dummy
# male & no degree
group.means["Male & No degree"]
# Chunk 18
# apply weights for female & no degree
lm.dummy.coef %*% c(1, 1, 0, 0)
# female & no degree
group.means["Female & No degree"]
# b1
b1.dummy
# female & no degree - male & no degree
group.means["Female & No degree"] - group.means["Male & No degree"]
# Chunk 19
# apply weights for male & degree
lm.dummy.coef %*% c(1, 0, 1, 0)
# female & no degree
group.means["Male & Degree"]
# b1
b2.dummy
# male & degree - male & no degree
group.means["Male & Degree"] - group.means["Male & No degree"]
# Chunk 20
# apply weights for female & degree
lm.dummy.coef %*% c(1, 1, 1, 1)
# female & degree
group.means["Female & Degree"]
# b3
b3.dummy
# female & degree + male & no degree - female & no degree - male & degree
group.means["Female & Degree"] + group.means["Male & No degree"] - group.means["Female & No degree"] - group.means["Male & Degree"]
# Chunk 21
C7T15 %>%
count(Sex.lbl, Education.lbl, Sex.Education, female.contrast, degree.contrast, female.contrast * degree.contrast) %>%
rename(interaction = `female.contrast * degree.contrast`) %>%
kable()
# Chunk 22
summary(lm.contrast)
# Chunk 23
# coefficients
lm.contrast.coef <- coefficients(lm.contrast)
# b0/intercept
b0.contrast <- lm.contrast.coef[1]
# b1
b1.contrast <- lm.contrast.coef[2]
# b2
b2.contrast <- lm.contrast.coef[3]
# b3/interaction
b3.contrast <- lm.contrast.coef[4]
# apply weights for male & no degree
lm.contrast.coef %*% c(1, 0, 0, 0)
# b0/intercept
b0.contrast
# mean of group means
mean(group.means)
C7T15 %>%
count(Sex.lbl, Education.lbl, Sex.Education, female.contrast, degree.contrast, female.contrast * degree.contrast) %>%
rename(interaction = `female.contrast * degree.contrast`)
C7T15 %>%
count(Sex.lbl, Education.lbl, Sex.Education, female.contrast, degree.contrast, female.contrast * degree.contrast) %>%
rename(interaction = `female.contrast * degree.contrast`) %>% View()
# mean of female means - mean of male means
(group.means["Female & No degree"] + group.means["Female & Degree"]) / 2 - (group.means["Male & No degree"] + group.means["Male & Degree"]) / 2
# b1
b1.contrast
# mean of female means - mean of male means
group.means["Female & No degree"] + group.means["Female & Degree"] / 2 - group.means["Male & No degree"] + group.means["Male & Degree"] / 2
# mean of female means - mean of male means
(group.means["Female & No degree"] + group.means["Female & Degree"] / 2) - (group.means["Male & No degree"] + group.means["Male & Degree"] / 2)
# mean of female means - mean of male means
(group.means["Female & No degree"] + group.means["Female & Degree"]) / 2 - (group.means["Male & No degree"] + group.means["Male & Degree"]) / 2
# b1
b1.contrast
C7T15 %>%
count(Sex.lbl, Education.lbl, Sex.Education, female.contrast, degree.contrast, female.contrast * degree.contrast) %>%
rename(interaction = `female.contrast * degree.contrast`) %>% View()
# apply weights for gender main effect (female - male)
lm.contrast.coef %*% c(0, 1, 0, 0)
# b1
b1.contrast
# mean of female means - mean of male means
(group.means["Female & No degree"] + group.means["Female & Degree"] - group.means["Male & No degree"] - group.means["Male & Degree"]) / 2
# apply weights for degree main effect (degree - no degree)
lm.contrast.coef %*% c(0, 0, 1, 0)
# b1
b2.contrast
# mean of degree means - mean of no degree means
(group.means["Male & Degree"] + group.means["Female & Degree"] - group.means["Male & No degree"] - group.means["Female & No degree"]) / 2
# apply weights for female & degree
lm.contrast.coef %*% c(0, 0, 0, 1)
# b3
b3.contrast
#
(group.means["Male & No degree"] - group.means["Male & Degree"] - group.means["Female & No degree"] + group.means["Female & Degree"]) / 4
(group.means["Male & No degree"] - group.means["Male & Degree"] - group.means["Female & No degree"] + group.means["Female & Degree"]) / 4
# b3
b3.contrast
# apply weights for female & degree
lm.contrast.coef %*% c(0, 0, 0, 1)
#
(group.means["Male & No degree"] - group.means["Male & Degree"] - group.means["Female & No degree"] + group.means["Female & Degree"])
group.means["Female & Degree"]
group.means["Male & No degree"]
group.means["Male & Degree"]
group.means["Female & No degree"]
45 / 2 - 44 / 2
#
(group.means["Male & No degree"] - group.means["Male & Degree"] - group.means["Female & No degree"] + group.means["Female & Degree"]) / 2
sum(c(1, -1, -1, 1) / 2)
sum(abs(c(1, -1, -1, 1) / 2))
# apply weights for female & degree
lm.contrast.coef %*% c(0, 0, 0, 1)
# b3
b3.contrast
#
group.means["Male & No degree"] - group.means["Male & Degree"] - group.means["Female & No degree"] + group.means["Female & Degree"]
levels(C7T15$Sex.Education)
C7T15 %>%
count(Sex.lbl, Education.lbl, Sex.Education, female.dummy, degree.dummy, female.dummy * degree.dummy)
# Chunk 1
# install.packages("tidyverse")
# install.packages("knitr")
# install.packages("AMCP")
library(tidyverse)
library(knitr)
library(AMCP)
# Chunk 2
data("C7T15")
# Chunk 3
C7T15 %>%
kable()
# Chunk 4
C7T15$Salary <- C7T15$Salary * 1000
# Chunk 5
C7T15 <- C7T15 %>%
mutate(Sex.lbl = factor(recode(Sex, "1" = "Male", "2" = "Female"), levels = c("Male", "Female"), labels = c("Male", "Female")),
Education.lbl = factor(recode(Education, "1" = "No degree", "2" = "Degree"), levels = c("No degree", "Degree"), labels = c("No degree", "Degree")),
Sex.Education = interaction(Sex.lbl, Education.lbl, sep = " & "))
# Chunk 6
# print contrasts
contrasts(C7T15$Sex.lbl)
# represent these contrasts as numeric variables
# first column represents the intercept contrast
# second column represents the dummy coded contrast (0 = Male, 1 = Female)
C7T15$female.dummy <- model.matrix.lm(~ Sex.lbl, data = C7T15)[, 2]
# Chunk 7
# print contrasts
contrasts(C7T15$Education.lbl)
# represent these contrasts as numeric variables
# first column represents the intercept contrast
# second column represents the dummy coded contrast (0 = No degree, 1 = Degree)
C7T15$degree.dummy <- model.matrix.lm(~ Education.lbl, data = C7T15)[, 2]
# Chunk 8
# create new contrasts
contrasts(C7T15$Sex.lbl) <- cbind(Female = c(-1, 1) / 2)
# print contrasts
contrasts(C7T15$Sex.lbl)
# represent these contrasts as numeric variables
# first column represents the intercept contrast
# second column represents the effect coded contrast (-0.5 = Male, 0.5 = Female)
C7T15$female.effect <- model.matrix.lm(~ Sex.lbl, data = C7T15)[, 2]
# create new contrasts
contrasts(C7T15$Education.lbl) <- cbind(Degree = c(-1, 1) / 2)
# print contrasts
contrasts(C7T15$Education.lbl)
# represent these contrasts as numeric variables
# first column represents the intercept contrast
# second column represents the effect coded contrast (-0.5 = No degree, 0.5 = Degree)
C7T15$degree.effect <- model.matrix.lm(~ Education.lbl, data = C7T15)[, 2]
# Chunk 9
C7T15 %>%
ggplot(mapping = aes(x = Sex.lbl, y = Salary, color = Education.lbl)) +
geom_violin(position = position_dodge(width = 0.90), alpha = 0) +
geom_boxplot(position = position_dodge(width = 0.90), width = 0.25, alpha = 0, outlier.color = NULL) +
geom_point(position = position_jitterdodge(jitter.width = 0.20, jitter.height = 0.20, dodge.width = 0.90)) +
scale_y_continuous(breaks = seq(0, 30000, 2000)) +
labs(x = "Sex", y = "Salary", color = "Education") +
theme_bw()
# Chunk 10
C7T15 %>%
ggplot(mapping = aes(x = Sex.lbl, y = Salary, fill = Education.lbl)) +
stat_summary(geom = "bar", fun.data = mean_cl_normal, position = position_dodge(width = 0.90)) +
stat_summary(geom = "errorbar", fun.data = mean_cl_normal, position = position_dodge(width = 0.90), width = 0) +
scale_y_continuous(breaks = seq(0, 40000, 2000)) +
labs(x = "Sex", y = "Salary", color = "Education") +
theme_bw()
# Chunk 11
lm.dummy <- lm(Salary ~ female.dummy * degree.dummy, data = C7T15)
# Chunk 12
lm.effect <- lm(Salary ~ female.effect * degree.effect, data = C7T15)
# Chunk 13
group.means <- with(C7T15, by(Salary, Sex.Education, mean))
# Chunk 14
C7T15 %>%
count(Sex.lbl, Education.lbl, Sex.Education, female.dummy, degree.dummy, female.dummy * degree.dummy) %>%
rename(interaction = `female.dummy * degree.dummy`) %>%
kable()
# Chunk 15
summary(lm.dummy)
# Chunk 16
# coefficients
lm.dummy.coef <- coefficients(lm.dummy)
# b0/intercept
b0.dummy <- lm.dummy.coef[1]
# b1
b1.dummy <- lm.dummy.coef[2]
# b2
b2.dummy <- lm.dummy.coef[3]
# b3/interaction
b3.dummy <- lm.dummy.coef[4]
# Chunk 17
# apply weights for male & no degree
lm.dummy.coef %*% c(1, 0, 0, 0)
# b0/intercept
b0.dummy
# male & no degree
group.means["Male & No degree"]
# Chunk 18
# apply weights for female & no degree
lm.dummy.coef %*% c(1, 1, 0, 0)
# female & no degree
group.means["Female & No degree"]
# b1
b1.dummy
# female & no degree - male & no degree
group.means["Female & No degree"] - group.means["Male & No degree"]
# Chunk 19
# apply weights for male & degree
lm.dummy.coef %*% c(1, 0, 1, 0)
# female & no degree
group.means["Male & Degree"]
# b1
b2.dummy
# male & degree - male & no degree
group.means["Male & Degree"] - group.means["Male & No degree"]
# Chunk 20
# apply weights for female & degree
lm.dummy.coef %*% c(1, 1, 1, 1)
# female & degree
group.means["Female & Degree"]
# b3
b3.dummy
# female & degree + male & no degree - female & no degree - male & degree
group.means["Female & Degree"] + group.means["Male & No degree"] - group.means["Female & No degree"] - group.means["Male & Degree"]
# Chunk 21
C7T15 %>%
count(Sex.lbl, Education.lbl, Sex.Education, female.effect, degree.effect, female.effect * degree.effect) %>%
rename(interaction = `female.effect * degree.effect`) %>%
kable()
# Chunk 22
summary(lm.effect)
# Chunk 23
# coefficients
lm.effect.coef <- coefficients(lm.effect)
# b0/intercept
b0.effect <- lm.effect.coef[1]
# b1
b1.effect <- lm.effect.coef[2]
# b2
b2.effect <- lm.effect.coef[3]
# b3/interaction
b3.effect <- lm.effect.coef[4]
# Chunk 24
# apply weights for intercept
lm.effect.coef %*% c(1, 0, 0, 0)
# b0/intercept
b0.effect
# mean of group means
mean(group.means)
# Chunk 25
# apply weights for gender main effect (female - male)
lm.effect.coef %*% c(0, 1, 0, 0)
# b1
b1.effect
# mean of female means - mean of male means
(group.means["Female & No degree"] + group.means["Female & Degree"] - group.means["Male & No degree"] - group.means["Male & Degree"]) / 2
# Chunk 26
# apply weights for degree main effect (degree - no degree)
lm.effect.coef %*% c(0, 0, 1, 0)
# b2
b2.effect
# mean of degree means - mean of no degree means
(group.means["Male & Degree"] + group.means["Female & Degree"] - group.means["Male & No degree"] - group.means["Female & No degree"]) / 2
# Chunk 27
# apply weights for female & degree
lm.effect.coef %*% c(0, 0, 0, 1)
# b3
b3.effect
# degree difference in males - degree difference in females
group.means["Male & No degree"] - group.means["Male & Degree"] - group.means["Female & No degree"] + group.means["Female & Degree"]
# Chunk 28
C7T15 <- C7T15 %>%
mutate(interaction.dummy = recode(Sex.Education, "Male & No degree" = 1, "Male & Degree" = 0, "Female & No degree" = 0, "Female & Degree" = 1),
interaction.effect = recode(Sex.Education, "Male & No degree" = 1, "Male & Degree" = -1, "Female & No degree" = -1, "Female & Degree" = 1))
lm(Salary ~ female.dummy + degree.dummy + interaction.dummy, data = C7T15)
lm(Salary ~ female.effect + degree.effect + interaction.effect, data = C7T15)
C7T15 <- C7T15 %>%
mutate(interaction.dummy = recode(Sex.Education, "Male & No degree" = 0, "Male & Degree" = 1, "Female & No degree" = 1, "Female & Degree" = 0),
interaction.effect = recode(Sex.Education, "Male & No degree" = 1, "Male & Degree" = -1, "Female & No degree" = -1, "Female & Degree" = 1))
lm(Salary ~ female.dummy + degree.dummy + interaction.dummy, data = C7T15)
lm(Salary ~ female.effect + degree.effect + interaction.effect, data = C7T15)
C7T15 <- C7T15 %>%
mutate(interaction.dummy = recode(Sex.Education, "Male & No degree" = 1, "Male & Degree" = 0, "Female & No degree" = 0, "Female & Degree" = 1),
interaction.effect = recode(Sex.Education, "Male & No degree" = 0.5, "Male & Degree" = -0.5, "Female & No degree" = -0.5, "Female & Degree" = 0.5))
lm(Salary ~ female.dummy + degree.dummy + interaction.dummy, data = C7T15)
lm(Salary ~ female.effect + degree.effect + interaction.effect, data = C7T15)
mean(group.means)
C7T15 %>% count(Sex.Education, female.dummy, degree.dummy, interaction.dummy)
group.means
summary(lm(Salary ~ 1 - 1 + Sex.Education, data = C7T15))
summary(lm(Salary ~ 1 + Sex.Education, data = C7T15))
# b3
coefficients(lm.dummy) %*% c(0, 0, 0, 1)
# (female & degree - female & no degree) - (male & degree - male & no degree)
(group.means["Female & Degree"] - group.means["Female & No degree"]) - (group.means["Male & Degree"] - group.means["Male & No degree"])
C7T15 %>%
count(Sex.lbl, Education.lbl, Sex.Education, female.effect, degree.effect, female.effect * degree.effect) %>%
rename(interaction = `female.effect * degree.effect`)
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
C7T15 %>%
kable()
coefficients(lm(Salary ~ female.dummy + degree.dummy + interaction.dummy, data = C7T15))
coefficients(lm(Salary ~ female.effect + degree.effect + interaction.effect, data = C7T15))
blogdown:::serve_site()
blogdown:::serve_site()
